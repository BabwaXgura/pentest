<?php
/* 60% buatan Babwa mwehehe*/
error_reporting(0);
/*mengambil data fungsi dan logo*/


echo "$cln" . "$lbiru" . "

                                 __                            __              __                          __           
                                /  |                          /  |  V 1.0.1   /  |                        /  |          
  ______    ______   _______   _$$ |_     ______    _______  _$$ |_          _$$ |_     ______    ______  $$ |  _______ 
 /      \  /      \ /       \ / $$   |   /      \  /       |/ $$   |        / $$   |   /      \  /      \ $$ | /       |
/$$$$$$  |/$$$$$$  |$$$$$$$  |$$$$$$/   /$$$$$$  |/$$$$$$$/ $$$$$$/         $$$$$$/   /$$$$$$  |/$$$$$$  |$$ |/$$$$$$$/ 
$$ |  $$ |$$    $$ |$$ |  $$ |  $$ | __ $$    $$ |$$      \   $$ | __         $$ | __ $$ |  $$ |$$ |  $$ |$$ |$$      \ 
$$ |__$$ |$$$$$$$$/ $$ |  $$ |  $$ |/  |$$$$$$$$/  $$$$$$  |  $$ |/  |        $$ |/  |$$ \__$$ |$$ \__$$ |$$ | $$$$$$  |
$$    $$/ $$       |$$ |  $$ |  $$  $$/ $$       |/     $$/   $$  $$/         $$  $$/ $$    $$/ $$    $$/ $$ |/     $$/ 
$$$$$$$/   $$$$$$$/ $$/   $$/    $$$$/   $$$$$$$/ $$$$$$$/     $$$$/           $$$$/   $$$$$$/   $$$$$$/  $$/ $$$$$$$/  
$$ |                                                                                                                    
$$ |           recode by: Babwa    muslim cyber anonymous                                                                          
$$/                                                                                                                     

\e[32m
  
";
//pariabel pungsi pungsinya uhh 
require 'sistemPungsi.php';
function ingfoo($site){
  $Mxlkp = dns_get_record($site, DNS_MX);
  $mxrcrd = $Mxlkp[0]['target'];
  $mxip = gethostbyname($mxrcrd);
  $mx = gethostbyaddr($mxip);
  $mxresult = "\e[1m\e[36mIP      :\e[32m " . $mxip ."\n\e[36mHOSTNAME:\e[32m " . $mx ;
  return $mxresult;
}
function input($message){
    global $white, $bold, $hijaubg, $merahbg, $birubg, $cln, $lbiru, $fhijau;
    $kuningbg = "\e[100m";
    $inputstyle = $cln . $bold . $putih . "[!] " . $message . ": " . $putih;
  echo $inputstyle;
  }
function judul($url) {
  $data = readcontents($url);
  $title = preg_match('/<title[^>]*>(.*?)<\/title>/ims', $data, $matches) ? $matches[1] : null;
  return $title;
  }
  



function cloudetek($reallink){

  $urlhh    = "http://api.hackertarget.com/httpheaders/?q=" . $reallink;
  $resulthh = file_get_contents($urlhh);
  if (strpos($resulthh, 'cloudflare') !== false)
    {
      echo $putih . "Detected\n\e[0m";
    }
  else
    {
      echo "\e[92mGa Ada\n\e[0m";
    }
}

function robotttt($reallink){
  $rbturl    = $reallink . "/robots.txt";
  $rbthandle = curl_init($rbturl);
  curl_setopt($rbthandle, CURLOPT_SSL_VERIFYPEER, false);
  curl_setopt($rbthandle, CURLOPT_RETURNTRANSFER, TRUE);
  $rbtresponse = curl_exec($rbthandle);
  $rbthttpCode = curl_getinfo($rbthandle, CURLINFO_HTTP_CODE);
  if ($rbthttpCode == 200)
    {
      $rbtcontent = readcontents($rbturl);
      if ($rbtcontent == "")
        {
          echo "Found But Empty!";
        }
      else
        {
          echo "\e[92mFound \e[0m\n";
          echo "\e[36m\n-------------[ contents ]----------------  \e[0m\n";
          echo $rbtcontent;
          echo "\e[36m\n-----------[end of contents]-------------\e[0m";
        }
    }
  else
    {
      echo "\e[91mtidak dapat menemukan robots.txt! \e[0m\n";
    }
}
function CEMS($reallink){
  $cmssc  = readcontents($reallink);
  if (strpos($cmssc, '/wp-content/') !== false)
    {
      $tcms = "WordPress";

    }
  else
    {
      if (strpos($cmssc, 'Joomla') !== false)
        {
          $tcms = "Joomla";
        }
      else
        {
          $drpurl = $reallink . "/misc/drupal.js";
          $drpsc  = readcontents("$drpurl");
          if (strpos($drpsc, 'Drupal') !== false)
            {
              $tcms = "Drupal";
            }
          else
            {
              if (strpos($cmssc, '/skin/frontend/') !== false)
                {
                  $tcms = "Magento";
                }
              else
                {
                  if (strpos($cmssc, 'content="WordPress')!== false) {
                    $tcms = "WordPress";
                  }
                  else {


                  $tcms = "\e[91mCould Not Detect";
                }
                }
            }
        }
    }
    return $tcms;
}
function cuerperr($urlws){
  stream_context_set_default( [
    'ssl' => [
        'verify_peer' => false,
        'verify_peer_name' => false,
    ],
]);
  $wsheaders = get_headers($urlws, 1);
  if (is_array($wsheaders['Server'])) { $ws = $wsheaders['Server'][0];}else{
    $ws = $wsheaders['Server'];
  }
  if ($ws == "")
    {
      echo "\e[91mga ada\e[0m";
    }
  else
    {
      echo "\e[92m$ws \e[0m";
    }
}

function gethttpheader($reallink){
  $hdr = get_headers($reallink);
  foreach ($hdr as $shdr) {
    echo "\n\e[92m\e[1m[i]\e[0m  $shdr";
  }
  echo "\n";

}
function readcontents($urltoread){
  $arrContextOptions=array(
      "ssl"=>array(
            "verify_peer"=>false,
            "verify_peer_name"=>false,
        ),
    );
    $filecntns = file_get_contents($urltoread, false, stream_context_create($arrContextOptions));
    return $filecntns;
}

if (extension_loaded('curl') || extension_loaded('dom')) {
} else {
    if (!extension_loaded('curl')) {
        echo $bold . $red . "
[!] curl belum ke install, install dulu" . $cln;
    }
    if (!extension_loaded('dom')) {
        echo $bold . $red . "
[!] DOM blum ke install, Install php-xml
" . $cln;
    }
}
echo $cln;
system("cls");
sistemulai:
    echo "
";


    input($putih . "WEBSITE ");
    $ip = trim(fgets(STDIN, 1024));
    if (strpos($ip, '://') !== false) {
        echo $bold . $lbiru . "
[!] ga usah pake (HTTPS/HTTP)
" . $CURLOPT_RETURNTRANSFER;
        goto sistemulai;
    } elseif (strpos($ip, '.') == false) {
        echo $bold . $oren . "
[!] MASUKAN URL YANG VALID ONII CHAN
" . $cln;
        goto sistemulai;
    } else {
        echo "
";
        $ipsl = "https://";

        system("clear");
        system("cls");
        echo "

";
        $reallink = $ipsl . $ip;
        $lwwww = str_replace("www.", "", $ip);
        echo $biru . $bold . "[i] ingfo kang scan awokawok 
";
        echo "

";
        echo ingfoo($lwwww);
        echo "

";
        echo "#########################";
        echo "$hijau" . "\nDATA KAMU MWEHEHE
";
        echo "$lbiru" . "##############################
";
        $ingfoan = "https://ipinfo.io";
        $resultmwehe = file_get_contents($ingfoan);
        echo "  ";
        echo $resultmwehe;
        echo "\n#########################";
        echo "
$bold" . "$hijau" . "INGFO DASAR 
";
        echo $lbiru . "#############################
";
        echo "
\e[0m";
        $reallink = $ipsl . $ip;
        $srccd = file_get_contents($reallink);
        $lwwww = str_replace("www.", "", $ip);
        echo "
$biru" . "[+] Judul Web: ";
        echo "\e[92m";
        echo judul($reallink);
        echo "\e[0m";
        $wip = gethostbyname($ip);
        echo "$biru" . "\n[+] Web Server: ";
        cuerperr($reallink);
        echo "
";
        echo "
$biru" . "[+] IP : ";
        echo "\e[92m";
        echo $wip . "
\e[0m";

        echo "$biru" . "[+] CMS: \e[92m" . CEMS($reallink) . " \e[0m";
        echo "
$biru" . "[+] Cloudflare: ";
        cloudetek($reallink);
        echo "$biru" . "[+] Robots File:$cln ";
        robotttt($reallink);
        echo "

$cln";
        echo "####################################";
        echo "

$bold" . $hijau . "S U B - D O M A I N   F I N D E R
";
        echo $lbiru . "###########################################==";
        echo "

";
        $urlsd = "http://api.hackertarget.com/hostsearch/?q=" . $lwwww;
        $resultsd = file_get_contents($urlsd);
        $subdomains = trim($resultsd, "
");
        $subdomains = explode("
", $subdomains);
        unset($subdomains['0']);
        $sdcount = count($subdomains);
        echo "
$biru" . "[i] Total Subdomains Found :$cln " . $hijau . $sdcount . "

$cln";
        foreach ($subdomains as $subdomain) {
            echo "[+] Subdomain:$cln $fhijau" . (str_replace(",", "
\e[0m[-] IP:$cln $fhijau", $subdomain));
            echo "

$cln";
        }
        echo "

";
            echo "#########################################";
            echo "\n\n$bold" . $lblue . "N M A P   P O R T   S C A N\n";
            echo "#########################################";
            echo "\n\n$cln";
            $urlnmap    = "http://api.hackertarget.com/nmap/?q=" . $lwwww;
            $resultnmap = file_get_contents($urlnmap);
            echo $resultnmap;
            echo "\n";
        echo "#########################";
        echo "

$bold" . $hijau . "W H O I S   L O O K U P
";
        echo $lbiru . "##########################################";
        echo "

$cln";
        $urlwhois = "http://api.hackertarget.com/whois/?q=" . $lwwww;
        $resultwhois = file_get_contents($urlwhois);
        echo "  ";
        echo $resultwhois;
        echo "

$cln";
        echo "#############################################";
        echo "

$bold" . $hijau . "G E O  I P  L O O K  U P  S C A N N E R
";
        echo $lbiru . "###########################################";
        echo "

$cln";
        $urlgip = "http://api.hackertarget.com/geoip/?q=" . $lwwww;
        $resultgip = readcontents($urlgip);
        $geoips = explode("
", $resultgip);
        foreach ($geoips as $geoip) {
            echo $bold . $hijau . "[i]$cln $geoip 
";
        }
        echo "

$cln";
        echo "####################################";
        echo "

$bold" . $hijau . "H T T P   H E A D E R S  S C A N N E R
";
        echo $lbiru . "###########################################";
        echo "

$cln";
        gethttpheader($reallink);
        echo "

";
        echo "###############################################";
        echo "

$bold" . $hijau . "D N S   L O O K U P  S C A N  N E R
";
        echo $lbiru . "############################################3";
        echo "

$cln";
        $urldlup = "http://api.hackertarget.com/dnslookup/?q=" . $lwwww;
        $resultdlup = file_get_contents($urldlup);
        echo $resultdlup;
        echo "

";
            echo "#####################################################";
            echo "\n\n$bold" . $lblue . "S U B N E T   C A L C U L A T I O N\n";
            echo "#####################################################";
            echo "\n\n$cln";
            $urlscal    = "http://api.hackertarget.com/subnetcalc/?q=" . $lwwww;
            $resultscal = file_get_contents($urlscal);
            echo $resultscal;
            echo "\n\n";
        echo "

";
        echo "#####################################################";
        echo "

$bold" . $lbiru . "S Q L   V U L N  S C A N N E R
";
        echo "########################################################$cln";
        echo "
";
        $lulzurl = $ipsl . $ip;
        $html = file_get_contents($lulzurl);
        $dom = new DOMDocument;
        @$dom->loadHTML($html);
        $links = $dom->getElementsByTagName('a');
        $vlnk = 0;
        foreach ($links as $link) {
            $lol = $link->getAttribute('href');
            if (strpos($lol, '?') !== false) {
                echo "
$biru [!] " . $fhijau . $lol . "
$cln";
                echo $biru . " [-] mencari vuln: ";
                $sqllist = "You have an error in your SQL syntax,supplied argument is not a valid MySQL result resource,check the manual that corresponds to your MySQL,mysql_fetch_array(),supplied argument is not a valid MySQL,function fetch_row(),Microsoft OLE DB Provider for ODBC Drivers error
";
                $sqlist = explode(',', $sqllist);
                if (strpos($lol, '://') !== false) {
                    $sqlurl = $lol . "'";
                } else {
                    $sqlurl = $ipsl . $ip . "/" . $lol . "'";
                }
                $sqlsc = file_get_contents($sqlurl);
                $sqlvn = "$red Not Found";
                foreach ($sqlist as $sqli) {
                    if (strpos($sqlsc, $sqli) !== false) $sqlvn = "$hijau Found!";
                }
                echo $sqlvn;
                echo "
$cln";
                echo "
";
                $vlnk++;
            }
        }
        echo "

$biru [+] URL(s) With Parameter(s):" . $hijau . $vlnk;
        echo "

";
    }
    input($lbiru . "enter untuk scan lagi, tekan e untuk exit ");
    $nganu = trim(fgets(STDIN, 1024));
    if ($nganu == "e" or "E") {
        die();
    } else {
        echo "ASSALAMULAIKUM, BYE BWAA";
        goto  sistemulai;
}
?>
